<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Seasonal Tree Product Dose Calculator</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: system-ui, sans-serif; background:#f5f5f5; margin:0; }
    header { background:#0d6efd; color:#fff; padding:1rem 1.5rem; }
    main { max-width:1150px; margin:0 auto; padding:1.5rem; }
    .card { background:#fff; border-radius:12px; padding:1.25rem 1.5rem 1.5rem; box-shadow:0 10px 35px rgba(0,0,0,.05); }
    label { font-weight:600; display:block; margin-bottom:.25rem; }
    select,input { width:100%; padding:.45rem .55rem; border-radius:8px; border:1px solid #ddd; margin-bottom:.75rem; background:#fff; }
    .row { display:flex; gap:1rem; flex-wrap:wrap; }
    .col-4 { flex:1 1 220px; }
    .col-6 { flex:1 1 320px; }
    .tabs { display:flex; gap:.5rem; margin-top:1rem; margin-bottom:1rem; flex-wrap:wrap; }
    .tab-btn { border:1px solid #ddd; background:#fff; padding:.4rem .75rem; border-radius:999px; font-size:.8rem; cursor:pointer; }
    .tab-btn.active { background:#0d6efd; color:#fff; border-color:#0d6efd; }
    .panel { display:none; }
    .panel.active { display:block; }
    .results { background:#0d6efd0d; border:1px solid #0d6efd1f; border-radius:10px; padding:1rem 1.25rem; margin-top:1rem; }
    small { font-size:.7rem; color:#555; display:block; margin-top:-.2rem; margin-bottom:.5rem; }
    .disclaimer { font-size:.65rem; color:#888; margin-top:.65rem; }
    #useText, #ppeText { white-space:pre-line; }
    .label-box { background:#f0f4ff; border:1px solid #d7e1ff; padding:1rem; border-radius:8px; }
    .label-box a { display:inline-block; margin-top:.5rem; color:#0d6efd; font-weight:600; text-decoration:none; }
  </style>
</head>
<body>
<header><h1>Seasonal Tree Product Dose Calculator</h1></header>
<main>
  <div class="card">
    <div class="row">
      <div class="col-4">
        <label for="season">Season</label>
        <select id="season">
          <option value="">-- pick a season --</option>
          <option value="winter">Winter</option>
          <option value="spring">Spring</option>
          <option value="summer">Summer</option>
          <option value="fall">Fall</option>
        </select>
      </div>
      <div class="col-6">
        <label for="product">Product</label>
        <select id="product" disabled>
          <option value="">-- pick a season first --</option>
        </select>
      </div>
    </div>

    <div class="tabs" id="tabs" style="display:none">
      <button class="tab-btn active" data-tab="use">Use</button>
      <button class="tab-btn" data-tab="ppe">PPE & Application</button>
      <button class="tab-btn" data-tab="dose">Dose Calculator</button>
      <button class="tab-btn" data-tab="label">Label</button>
    </div>

    <!-- USE PANEL -->
    <div id="panel-use" class="panel active">
      <p id="useText">Pick a season, then a product.</p>
    </div>

    <!-- PPE PANEL -->
    <div id="panel-ppe" class="panel">
      <p id="ppeText">Select a product to see PPE and application notes.</p>
    </div>

    <!-- DOSE PANEL -->
    <div id="panel-dose" class="panel">
      <!-- Cambistat-only -->
      <div id="cambistatInputs" class="row" style="display:none">
        <div class="col-6">
          <label for="species">Tree species (Cambistat)</label>
          <select id="species"></select>
        </div>
        <div class="col-4">
          <label for="dbhCambistat">DBH (inches)</label>
          <input id="dbhCambistat" type="number" min="4" max="47" step="1" value="10" />
          <small>Cambistat table is 4â€“47 inches</small>
        </div>
      </div>

      <!-- generic DBH -->
      <div id="dbhInputs" class="row" style="display:none">
        <div class="col-4">
          <label for="dbh">DBH (inches)</label>
          <input id="dbh" type="number" min="1" step="0.1" value="10" />
        </div>
      </div>

      <!-- method -->
      <div id="methodWrap" class="row" style="display:none">
        <div class="col-4">
          <label for="method">Application method</label>
          <select id="method"></select>
        </div>
      </div>

      <!-- pest/rate -->
      <div id="pestWrap" class="row" style="display:none">
        <div class="col-6">
          <label for="pest">Target / rate</label>
          <select id="pest"></select>
        </div>
      </div>

      <!-- spray -->
      <div id="sprayInputs" class="row" style="display:none">
        <div class="col-4">
          <label for="sprayVol">Spray / drench volume (gallons)</label>
          <input id="sprayVol" type="number" min="1" step="0.5" value="25" />
        </div>
      </div>

      <!-- results -->
      <div id="results" class="results" style="display:none">
        <h3>Dose</h3>
        <p id="doseText"></p>
        <p id="waterText"></p>
        <p id="totalText"></p>
        <p class="disclaimer">
          Always follow the current specimen label. This tool summarizes rates and PPE and is not a substitute for the label.
        </p>
      </div>
    </div>

    <!-- LABEL PANEL -->
    <div id="panel-label" class="panel">
      <div class="label-box" id="labelBox">
        Select a product and its label link will appear here.
      </div>
    </div>
  </div>
</main>

<script>
/* ---------- SEASONS â†’ PRODUCTS ---------- */
const seasonProducts = {
  winter: ["cambistat","reliant","alamo","moistureaide","trimtect"],
  spring: ["xytect2f","xytect10","transtect70","transtectInfusible","proxite","bifenamite2sc","abamectin015","scrimmage","diamid","junction","biorush","reliant","mectinite","lepitect"],
  summer: ["myclotect","transtect70","transtectInfusible","lepitect","mectinite","moistureaide","onmark","scrimmage","bifenamite2sc","proxite"],
  fall: ["cambistat","xytect2f","alamo","trimtect","junction","moistureaide","reliant"]
};

/* ---------- CAMBISTAT TABLE (4â€“47") ---------- */
const cambistatData = {
  "4":{"A":{"product":17,"water":185},"B":{"product":23,"water":250},"C":{"product":42,"water":460},"D":{"product":46,"water":510},"E":{"product":50,"water":550},"F":{"product":67,"water":735}},
  "5":{"A":{"product":21,"water":230},"B":{"product":28,"water":310},"C":{"product":52,"water":575},"D":{"product":57,"water":630},"E":{"product":63,"water":690},"F":{"product":83,"water":920}},
  "6":{"A":{"product":25,"water":275},"B":{"product":33,"water":370},"C":{"product":63,"water":690},"D":{"product":69,"water":760},"E":{"product":75,"water":825},"F":{"product":100,"water":1100}},
  "7":{"A":{"product":44,"water":480},"B":{"product":58,"water":645},"C":{"product":73,"water":805},"D":{"product":80,"water":885},"E":{"product":88,"water":965},"F":{"product":117,"water":1285}},
  "8":{"A":{"product":50,"water":550},"B":{"product":67,"water":735},"C":{"product":83,"water":920},"D":{"product":92,"water":1000},"E":{"product":100,"water":1100},"F":{"product":133,"water":1470}},
  "9":{"A":{"product":56,"water":620},"B":{"product":75,"water":825},"C":{"product":94,"water":1030},"D":{"product":103,"water":1135},"E":{"product":113,"water":1240},"F":{"product":150,"water":1650}},
  "10":{"A":{"product":63,"water":690},"B":{"product":83,"water":920},"C":{"product":104,"water":1145},"D":{"product":115,"water":1260},"E":{"product":125,"water":1375},"F":{"product":167,"water":1835}},
  "11":{"A":{"product":69,"water":755},"B":{"product":92,"water":1010},"C":{"product":115,"water":1260},"D":{"product":126,"water":1390},"E":{"product":138,"water":1515},"F":{"product":183,"water":2020}},
  "12":{"A":{"product":75,"water":825},"B":{"product":100,"water":1100},"C":{"product":125,"water":1375},"D":{"product":138,"water":1515},"E":{"product":150,"water":1650},"F":{"product":200,"water":2200}},
  "13":{"A":{"product":81,"water":900},"B":{"product":108,"water":1190},"C":{"product":135,"water":1490},"D":{"product":149,"water":1640},"E":{"product":163,"water":1790},"F":{"product":217,"water":2385}},
  "14":{"A":{"product":88,"water":965},"B":{"product":117,"water":1285},"C":{"product":146,"water":1605},"D":{"product":160,"water":1765},"E":{"product":175,"water":1925},"F":{"product":233,"water":2570}},
  "15":{"A":{"product":94,"water":1030},"B":{"product":125,"water":1375},"C":{"product":156,"water":1720},"D":{"product":172,"water":1895},"E":{"product":188,"water":2065},"F":{"product":250,"water":2750}},
  "16":{"A":{"product":100,"water":1100},"B":{"product":133,"water":1470},"C":{"product":167,"water":1835},"D":{"product":183,"water":2020},"E":{"product":200,"water":2200},"F":{"product":267,"water":2935}},
  "17":{"A":{"product":106,"water":1170},"B":{"product":142,"water":1560},"C":{"product":177,"water":1950},"D":{"product":195,"water":2145},"E":{"product":213,"water":2340},"F":{"product":283,"water":3120}},
  "18":{"A":{"product":113,"water":1240},"B":{"product":150,"water":1650},"C":{"product":188,"water":2065},"D":{"product":206,"water":2270},"E":{"product":225,"water":2475},"F":{"product":300,"water":3300}},
  "19":{"A":{"product":119,"water":1310},"B":{"product":158,"water":1745},"C":{"product":198,"water":2177},"D":{"product":218,"water":2395},"E":{"product":238,"water":2615},"F":{"product":317,"water":3485}},
  "20":{"A":{"product":125,"water":1375},"B":{"product":167,"water":1835},"C":{"product":208,"water":2290},"D":{"product":229,"water":2520},"E":{"product":250,"water":2750},"F":{"product":333,"water":3670}},
  "21":{"A":{"product":131,"water":1445},"B":{"product":175,"water":1925},"C":{"product":219,"water":2410},"D":{"product":241,"water":2650},"E":{"product":263,"water":2890},"F":{"product":350,"water":3850}},
  "22":{"A":{"product":138,"water":1515},"B":{"product":183,"water":2020},"C":{"product":229,"water":2520},"D":{"product":252,"water":2775},"E":{"product":275,"water":3025},"F":{"product":367,"water":4035}},
  "23":{"A":{"product":144,"water":1580},"B":{"product":192,"water":2110},"C":{"product":240,"water":2635},"D":{"product":264,"water":2900},"E":{"product":288,"water":3165},"F":{"product":383,"water":4220}},
  "24":{"A":{"product":150,"water":1650},"B":{"product":200,"water":2200},"C":{"product":250,"water":2750},"D":{"product":275,"water":3025},"E":{"product":300,"water":3300},"F":{"product":400,"water":4400}},
  "25":{"A":{"product":156,"water":1720},"B":{"product":208,"water":2295},"C":{"product":260,"water":2865},"D":{"product":287,"water":3150},"E":{"product":313,"water":3440},"F":{"product":417,"water":4585}},
  "26":{"A":{"product":162,"water":1787},"B":{"product":217,"water":2385},"C":{"product":271,"water":2980},"D":{"product":298,"water":3277},"E":{"product":325,"water":3575},"F":{"product":433,"water":4765}},
  "27":{"A":{"product":169,"water":1855},"B":{"product":225,"water":2475},"C":{"product":281,"water":3095},"D":{"product":310,"water":3400},"E":{"product":338,"water":3715},"F":{"product":450,"water":4950}},
  "28":{"A":{"product":175,"water":1925},"B":{"product":233,"water":2570},"C":{"product":292,"water":3210},"D":{"product":321,"water":3530},"E":{"product":350,"water":3850},"F":{"product":467,"water":5135}},
  "29":{"A":{"product":181,"water":1995},"B":{"product":242,"water":2660},"C":{"product":302,"water":3320},"D":{"product":332,"water":3660},"E":{"product":363,"water":3990},"F":{"product":483,"water":5320}},
  "30":{"A":{"product":188,"water":2060},"B":{"product":250,"water":2750},"C":{"product":313,"water":3440},"D":{"product":344,"water":3780},"E":{"product":375,"water":4125},"F":{"product":500,"water":5500}},
  "31":{"A":{"product":194,"water":2130},"B":{"product":258,"water":2840},"C":{"product":323,"water":3550},"D":{"product":355,"water":3910},"E":{"product":388,"water":4265},"F":{"product":517,"water":5685}},
  "32":{"A":{"product":200,"water":2200},"B":{"product":267,"water":2930},"C":{"product":333,"water":3670},"D":{"product":367,"water":4035},"E":{"product":400,"water":4400},"F":{"product":533,"water":5870}},
  "33":{"A":{"product":206,"water":2270},"B":{"product":275,"water":3025},"C":{"product":345,"water":3780},"D":{"product":378,"water":4160},"E":{"product":413,"water":4540},"F":{"product":550,"water":6050}},
  "34":{"A":{"product":213,"water":2340},"B":{"product":283,"water":3120},"C":{"product":354,"water":3900},"D":{"product":390,"water":4285},"E":{"product":425,"water":4675},"F":{"product":567,"water":6235}},
  "35":{"A":{"product":219,"water":2405},"B":{"product":292,"water":3210},"C":{"product":365,"water":4010},"D":{"product":401,"water":4410},"E":{"product":438,"water":4810},"F":{"product":583,"water":6415}},
  "36":{"A":{"product":225,"water":2475},"B":{"product":300,"water":3300},"C":{"product":375,"water":4125},"D":{"product":413,"water":4540},"E":{"product":450,"water":4950},"F":{"product":600,"water":6600}},
  "37":{"A":{"product":231,"water":2545},"B":{"product":308,"water":3390},"C":{"product":386,"water":4240},"D":{"product":424,"water":4664},"E":{"product":463,"water":5090},"F":{"product":617,"water":6780}},
  "38":{"A":{"product":238,"water":2610},"B":{"product":317,"water":3480},"C":{"product":396,"water":4355},"D":{"product":435,"water":4790},"E":{"product":475,"water":5225},"F":{"product":633,"water":6970}},
  "39":{"A":{"product":244,"water":2680},"B":{"product":325,"water":3575},"C":{"product":406,"water":4470},"D":{"product":447,"water":4915},"E":{"product":488,"water":5365},"F":{"product":650,"water":7150}},
  "40":{"A":{"product":250,"water":2750},"B":{"product":333,"water":3670},"C":{"product":417,"water":4585},"D":{"product":458,"water":5040},"E":{"product":500,"water":5500},"F":{"product":667,"water":7335}},
  "41":{"A":{"product":256,"water":2820},"B":{"product":342,"water":3760},"C":{"product":427,"water":4700},"D":{"product":470,"water":5168},"E":{"product":513,"water":5640},"F":{"product":683,"water":7520}},
  "42":{"A":{"product":263,"water":2890},"B":{"product":350,"water":3850},"C":{"product":438,"water":4815},"D":{"product":481,"water":5295},"E":{"product":525,"water":5775},"F":{"product":700,"water":7700}},
  "43":{"A":{"product":269,"water":2955},"B":{"product":358,"water":3940},"C":{"product":448,"water":4930},"D":{"product":493,"water":5420},"E":{"product":538,"water":5915},"F":{"product":717,"water":7885}},
  "44":{"A":{"product":275,"water":3025},"B":{"product":367,"water":4035},"C":{"product":458,"water":5040},"D":{"product":504,"water":5545},"E":{"product":550,"water":6050},"F":{"product":733,"water":8065}},
  "45":{"A":{"product":281,"water":3095},"B":{"product":375,"water":4125},"C":{"product":469,"water":5155},"D":{"product":516,"water":5670},"E":{"product":563,"water":6190},"F":{"product":750,"water":8250}},
  "46":{"A":{"product":288,"water":3160},"B":{"product":383,"water":4220},"C":{"product":479,"water":5270},"D":{"product":527,"water":5800},"E":{"product":575,"water":6325},"F":{"product":767,"water":8435}},
  "47":{"A":{"product":294,"water":3230},"B":{"product":392,"water":4310},"C":{"product":490,"water":5385},"D":{"product":539,"water":5924},"E":{"product":588,"water":6463},"F":{"product":783,"water":8615}}
};

/* ---------- SPECIES â†’ CATEGORY (full) ---------- */
const speciesToCategory = {
  "Acacia": "F","Ailanthus": "D","Alder": "F","Anaqua": "E","Arborvitae": "F","Ash": "F","Aspen": "F","Australian Bottle": "C","Australian Pine": "A",
  "Bald Cypress": "F","Banyan - Ficus": "F","Basswood, American": "A","Baytree": "E","Beech": "E","Birch": "F","Bischofia": "F","Black Gum / Tupelo": "B",
  "Black Olive": "F","Bottlebrush": "F","Boxelder": "A","Buckeye": "D","Buttonwood": "F","California Pepper": "C","Camphor": "E","Catalpa": "E",
  "Cedar â€“ Deodora": "E","Cedar - all others": "F","Cherry - Black": "F","Cherry - Ornamental": "E","Cherry - Laurel": "E","Chinaberry": "E",
  "Chinese Pistache": "E","Cottonwood*": "F","Crabapple": "F","Crape Myrtle": "B","Cryptomeria": "F","Cypress": "B","Ebony - Texas": "F","Elm - Cedar": "B",
  "Elm - Chinese/Lacebark": "A","Elm - Siberian": "A","Elm - (all others)": "B","Eucalyptus": "F","Ficus": "F","Fir": "F","Ginkgo": "F","Gumbo Limbo": "F",
  "Hackberry": "F","Hawthorn": "C","Hickory": "E","Holly - American": "E","Holly â€“ Nellie Stevens": "E","Holly - Yaupon": "B","Horsechestnut": "C",
  "Huisache": "E","Ironwood / Hornbeam": "D","Jacaranda": "F","Japanese Tree Lilac": "E","Juniper": "F","Katsura - Japanese": "A","Larch": "F","Laurel": "F",
  "Leyland Cypress": "F","Linden": "A","Locust - Black": "F","Locust - Honey": "E","Lombardy Poplar": "F","Lysiloma": "F","Magnolia": "F","Mahogany": "F",
  "Maple - Amur": "B","Maple - Bigleaf": "D","Maple - Japanese (caution)**": "A","Maple - Norway": "B","Maple - Red": "B","Maple - Silver": "D",
  "Maple - Sugar": "B","Melaleuca": "F","Mesquite": "F","Mimosa": "E","Mountain Ash": "B","Mulberry": "F","Oak â€“ Black": "E","Oak â€“ Blackjack": "E",
  "Oak â€“ Bur": "D","Oak - Laurel": "F","Oak - Live (<10â€)": "B","Oak - Live (>10â€)": "E","Oak - Pin": "E","Oak - Post": "E","Oak - Red": "E",
  "Oak - Sand Shinnery": "E","Oak - Scarlet": "E","Oak - Shumard": "E","Oak - Valley": "F","Oak - Water": "E","Oak - White": "D","Oak - Willow": "E",
  "Olive - Black": "F","Olive - European": "E","Olive - Russian": "E","Orchid Tree - Hong Kong": "C","Osage Orange": "F","Palms": "F","Paloverde": "E",
  "Paulownia": "E","Pear - Ornamental": "F","Pecan": "E","Persimmon": "C","Photinia": "E","Pines*": "F","Plum - Ornamental": "E","Poinciana": "F",
  "Raintree - Golden": "F","Redcedar - Eastern": "F","Redwood": "F","Rosewood / Tipuana": "C","Russian Olive": "E","Saltcedar": "F","Sassafrass": "E",
  "Sea Grape": "E","Soapberry": "E","Spruce*": "F","Sugarberry / So. Hackberry": "F","Sumac - African": "E","Sycamore": "F","Tabebuia": "F",
  "Tallow - Chinese": "F","Tallowwood": "F","Tamarisk": "F","Tepeguaje": "E","Tulip / Yellow Poplar": "F","Tupelo / Black Gum": "B","Walnut": "E",
  "Waxmyrtle - Pacific": "F","Willow": "F","Xylosma": "C","Yellow Poplar / Tulip": "F","Yew": "F","Zelkova": "B"
};

/* ---------- PRODUCT CONFIG (with your PDF names) ---------- */
const productConfig = {
  cambistat: {
    name: "Cambistat",
    showCambistat: true,
    labelUrl: "labels/Cambistat%20Label.pdf",
    use: `Use: Tree growth regulator to reduce canopy growth, improve root growth and stress tolerance. Use species category Aâ€“F plus DBH to find exact mL product and water.
Application: Soil drench/injection around root flare per label.
Season: Often fallâ€“winter or when soil is workable.`,
    ppe: `PPE:
â€¢ Long-sleeved shirt and long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks
â€¢ Eye/face protection if splash hazard`
  },
  xytect2f: {
    name: "Xytect 2F",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Xytect%202F%20Label.pdf",
    methods: ["Soil injection","Soil drench"],
    pests: [
      {id:"standard", label:"Standard labeled insects â€“ 0.15 fl oz/in DBH", rateFlOz:0.15},
      {id:"heavy", label:"Higher pressure â€“ 0.3 fl oz/in DBH", rateFlOz:0.3},
      {id:"max", label:"Do not exceed label max â€“ 0.4 fl oz/in DBH", rateFlOz:0.4}
    ],
    use: `Use: Systemic imidacloprid for scale, aphids, adelgids, some borers.
Application: Inject or drench close to trunk for best uptake.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  xytect10: {
    name: "Xytect 10% (injection)",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Xytect%2010_%20Insecticide%20Label.pdf",
    methods: ["Trunk injection"],
    pests: [
      {id:"soft", label:"Soft-bodied pests (lower band)", group:"soft"},
      {id:"borer", label:"Borers / EAB (upper band)", group:"borer"}
    ],
    use: `Use: High-strength imidacloprid where soil treatments aren't suitable.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection`
  },
  transtect70: {
    name: "Transtect 70WSP",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Transtect%20Label.pdf",
    methods: ["Soil drench","Soil injection","Bark spray (label)"],
    pests: [{id:"general", label:"General labeled insects (per packet chart)", ratePackets:1}],
    use: `Use: Fast dinotefuran for many insects; flexible application.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  transtectInfusible: {
    name: "Transtect Infusible",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/TranstectInfusibleLabel.pdf",
    methods: ["Trunk injection"],
    use: `Use: Injection dinotefuran for labeled tree pests.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection`
  },
  trimtect: {
    name: "Trimtect",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Trimtect%20Label.pdf",
    methods: ["Basal/soil drench","Soil injection"],
    use: `Use: Growth regulator for trees/shrubs to reduce shoot growth.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  reliant: {
    name: "Reliant",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Reliant%20Label.pdf",
    methods: ["Trunk injection","Soil drench"],
    pests: [
      {id:"disease", label:"Label disease rate â€“ 10 mL/in, dilute 1 L/in", rateMlPerIn:10, waterLPerIn:1}
    ],
    use: `Use: Phosphite systemic for certain diseases.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection`
  },
  proxite: {
    name: "Proxite",
    showSpray: true,
    labelUrl: "labels/Proxite%20Label.pdf",
    pests: [
      {id:"ornLow", label:"Ornamentals â€“ 8 fl oz / 100 gal", rateFlOzPer100: 8},
      {id:"ornHigh", label:"Heavy â€“ 16 fl oz / 100 gal", rateFlOzPer100: 16}
    ],
    use: `Use: IGR for certain ornamental insects.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  myclotect: {
    name: "Myclotect",
    showSpray: true,
    labelUrl: "labels/Myclotect%20label-1.pdf",
    pests: [
      {id:"foliar", label:"Foliar diseases â€“ 6 fl oz / 100 gal", rateFlOzPer100: 6},
      {id:"higher", label:"Heavier disease â€“ 12 fl oz / 100 gal", rateFlOzPer100: 12}
    ],
    use: `Use: Myclobutanil ornamental fungicide.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection`
  },
  onmark: {
    name: "Onmark Herbicide",
    showSpray: true,
    labelUrl: "labels/Onmark%20Herbicide%20Label.pdf",
    pests: [
      {id:"1pct", label:"1% solution", percent:1},
      {id:"2pct", label:"2% solution", percent:2}
    ],
    use: `Use: Herbicide for labeled weeds/brush.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection
â€¢ Shoes plus socks`
  },
  bifenamite2sc: {
    name: "Bifenamite 2SC",
    showSpray: true,
    labelUrl: "labels/Bifenamite%202SC%20Label.pdf",
    pests: [
      {id:"mitesLow", label:"Mites â€“ 8 fl oz / 100 gal", rateFlOzPer100: 8},
      {id:"mitesHigh", label:"Mites (heavy) â€“ 16 fl oz / 100 gal", rateFlOzPer100: 16}
    ],
    use: `Use: Miticide for ornamental mites.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  biorush: {
    name: "Biorush Plus 3-0-11",
    showSpray: true,
    labelUrl: "labels/BIORUSH%20PLUS%203-0-11%20Specimen%20Label.pdf",
    use: `Use: Nutritional/biostimulant, 1 lb / 50 gal typical.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Gloves when handling dry material
â€¢ Shoes plus socks`
  },
  diamid: {
    name: "Diamid",
    showSpray: true,
    labelUrl: "labels/Diamid%20Label.pdf",
    pests: [
      {id:"orn", label:"Ornamentals â€“ 8 fl oz / 100 gal", rateFlOzPer100: 8}
    ],
    use: `Use: Ornamental insecticide.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  junction: {
    name: "Junction DF",
    showSpray: true,
    labelUrl: "labels/Junction_Speciman_Label.pdf",
    use: `Use: Copper + mancozeb fungicide/bactericide.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection
â€¢ Shoes plus socks`
  },
  lepitect: {
    name: "Lepitect Infusible",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Lepitect%20Infusible%20Specimen%20Label.pdf",
    methods: ["Trunk injection"],
    use: `Use: Acephate injection for leaf-feeding insects.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye/face protection`
  },
  mectinite: {
    name: "Mectinite",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Mectinite%20Label.pdf",
    methods: ["Trunk injection"],
    use: `Use: Emamectin benzoate injection for borers/EAB.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye protection`
  },
  moistureaide: {
    name: "MoistureAide",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/MoistureAide%20Label.pdf",
    methods: ["Soil drench","Soil injection"],
    use: `Use: Moisture management/wetting around root zone.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  scrimmage: {
    name: "Scrimmage 03F",
    showSpray: true,
    labelUrl: "labels/Scrimmage.pdf",
    pests: [
      {id:"withPesticide", label:"With insecticide/fungicide â€“ 16 fl oz/100 gal", rateFlOzPer100: 16},
      {id:"withHerbicide", label:"With herbicide â€“ 32 fl oz/100 gal", rateFlOzPer100: 32}
    ],
    use: `Use: Adjuvant to improve spread/coverage â€” only if main label allows.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  abamectin015: {
    name: "Abamectin 0.15 Select",
    showSpray: true,
    labelUrl: "labels/Abamectin%20Label.pdf",
    pests: [
      {id:"ornLow", label:"Ornamentals â€“ 8 fl oz/100 gal", rateFlOzPer100: 8},
      {id:"ornHigh", label:"Higher pressure â€“ 16 fl oz/100 gal", rateFlOzPer100: 16}
    ],
    use: `Use: Abamectin miticide/insecticide.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Shoes plus socks`
  },
  alamo: {
    name: "Alamo (propiconazole)",
    showDBH: true,
    showMethods: true,
    labelUrl: "labels/Alamo%20Label.pdf",
    methods: ["Flare-root injection"],
    pests: [
      {id:"oakWilt", label:"Oak wilt / preventive â€“ 10 mL/in DBH (dilute up to 1 L/in)", rateMlPerIn:10, waterLPerIn:1},
      {id:"oakWiltHigh", label:"Oak wilt / therapeutic â€“ 20 mL/in DBH (dilute up to 1 L/in)", rateMlPerIn:20, waterLPerIn:1},
      {id:"dutchElm", label:"Dutch elm disease â€“ 10 mL/in DBH", rateMlPerIn:10, waterLPerIn:1}
    ],
    use: `Use: Systemic fungicide injected into flare roots for oak wilt, DED.`,
    ppe: `PPE:
â€¢ Long sleeves, long pants
â€¢ Chemical-resistant gloves
â€¢ Eye/face protection
â€¢ Shoes plus socks`
  }
};

/* ---------- helpers ---------- */
function showSection(id, show){ document.getElementById(id).style.display = show ? "" : "none"; }
function formatMl(v){ return Math.round(v); }
function gallonsToMl(g){ return g*3785.41; }
function lbToGrams(lb){ return lb*453.592; }

/* populate species once */
function populateSpecies(){
  const sel=document.getElementById("species");
  sel.innerHTML="";
  Object.keys(speciesToCategory).sort().forEach(name=>{
    const opt=document.createElement("option");
    opt.value=name;
    opt.textContent=name;
    sel.appendChild(opt);
  });
}
populateSpecies();

/* season change â†’ load products */
document.getElementById("season").addEventListener("change", ()=>{
  const season = document.getElementById("season").value;
  const prodSel = document.getElementById("product");
  prodSel.innerHTML = "";
  if (!season || !seasonProducts[season]) {
    prodSel.disabled = true;
    prodSel.innerHTML = '<option value="">-- pick a season first --</option>';
    document.getElementById("tabs").style.display = "none";
    return;
  }
  seasonProducts[season].forEach(pid=>{
    const cfg = productConfig[pid];
    if (cfg){
      const opt = document.createElement("option");
      opt.value = pid;
      opt.textContent = cfg.name;
      prodSel.appendChild(opt);
    }
  });
  prodSel.disabled = false;
  document.getElementById("tabs").style.display = "";
  updateProductUI();
});

/* product change */
document.getElementById("product").addEventListener("change", updateProductUI);

function updateProductUI(){
  const product = document.getElementById("product").value;
  if (!product) return;
  const cfg = productConfig[product];

  // fill use / ppe
  document.getElementById("useText").textContent = cfg.use || "See label.";
  document.getElementById("ppeText").textContent = cfg.ppe || "See label.";

  // label tab
  const labelBox = document.getElementById("labelBox");
  if (cfg.labelUrl) {
    labelBox.innerHTML = `This product has a label.<br><a href="${cfg.labelUrl}" target="_blank" rel="noopener noreferrer">ðŸ“„ View label PDF</a>`;
  } else {
    labelBox.textContent = "Label not available in this project yet.";
  }

  // hide all calc inputs first
  showSection("cambistatInputs", false);
  showSection("dbhInputs", false);
  showSection("methodWrap", false);
  showSection("pestWrap", false);
  showSection("sprayInputs", false);
  showSection("results", false);

  // cambistat special
  if (cfg.showCambistat) {
    showSection("cambistatInputs", true);
    calcCambistat();
    return;
  }

  // DBH input
  if (cfg.showDBH) showSection("dbhInputs", true);

  // methods
  if (cfg.showMethods) {
    const mSel = document.getElementById("method");
    mSel.innerHTML = "";
    (cfg.methods || []).forEach(m=>{
      const o=document.createElement("option");
      o.value=m; o.textContent=m;
      mSel.appendChild(o);
    });
    showSection("methodWrap", true);
  }

  // pests/rates
  if (cfg.pests) {
    const pSel = document.getElementById("pest");
    pSel.innerHTML = "";
    (cfg.pests || []).forEach(p=>{
      const o=document.createElement("option");
      o.value=p.id;
      o.textContent=p.label;
      pSel.appendChild(o);
    });
    showSection("pestWrap", true);
  }

  // spray inputs
  if (cfg.showSpray) {
    showSection("sprayInputs", true);
  }

  computeCurrentProduct();
}

/* tabs behavior */
document.querySelectorAll(".tab-btn").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll(".tab-btn").forEach(b=>b.classList.remove("active"));
    document.querySelectorAll(".panel").forEach(p=>p.classList.remove("active"));
    btn.classList.add("active");
    document.getElementById(`panel-${btn.dataset.tab}`).classList.add("active");
  });
});

/* cambistat calc */
function calcCambistat(){
  const species = document.getElementById("species").value;
  const dbh = parseInt(document.getElementById("dbhCambistat").value, 10);
  const doseText = document.getElementById("doseText");
  const waterText = document.getElementById("waterText");
  const totalText = document.getElementById("totalText");

  if (isNaN(dbh) || dbh < 4 || dbh > 47) {
    showSection("results", true);
    doseText.textContent = "DBH must be between 4 and 47 in for Cambistat table.";
    waterText.textContent = "";
    totalText.textContent = "";
    return;
  }

  let category;
  if (species === "Oak - Live (<10â€)") {
    category = dbh < 10 ? "B" : "E";
  } else if (species === "Oak - Live (>10â€)") {
    category = dbh > 10 ? "E" : "B";
  } else {
    category = speciesToCategory[species] || "F";
  }

  const row = cambistatData[dbh];
  const cell = row[category];
  showSection("results", true);
  doseText.textContent = `Product: ${cell.product} mL Cambistat (Category ${category})`;
  waterText.textContent = `Water: ${cell.water} mL`;
  totalText.textContent = `Total: ${cell.product + cell.water} mL`;
}

/* main calculator */
function computeCurrentProduct(){
  const product = document.getElementById("product").value;
  const cfg = productConfig[product];
  if (!cfg) return;

  const doseText = document.getElementById("doseText");
  const waterText = document.getElementById("waterText");
  const totalText = document.getElementById("totalText");
  showSection("results", true);

  // Cambistat is separate
  if (cfg.showCambistat) return;

  // Xytect-style
  if (product === "xytect2f" || product === "xytect10") {
    const dbh = parseFloat(document.getElementById("dbh").value || "0");
    const pestId = document.getElementById("pest").value;
    const method = document.getElementById("method").value;
    const chosen = (cfg.pests || [])[0];
    const rateObj = (cfg.pests || []).find(p=>p.id===pestId) || chosen;
    const mlPerIn = (rateObj.rateFlOz || 0.15) * 29.5735;
    const productMl = mlPerIn * dbh;
    let waterMl;

    if (method === "Soil injection") {
      const gals = Math.max(1, dbh * 1);
      waterMl = gallonsToMl(gals);
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (â‰ˆ ${gals.toFixed(1)} gal)`;
    } else {
      const gals = 2;
      waterMl = gallonsToMl(gals);
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (example 2 gal drench)`;
    }

    doseText.textContent = `Product: ${Math.round(productMl)} mL ${cfg.name} at ${(rateObj.rateFlOz || 0.15)} fl oz/in Ã— ${dbh} in`;
    totalText.textContent = `Total mix: ${Math.round(productMl + waterMl)} mL`;
    return;
  }

  // Alamo / Reliant
  if (product === "alamo" || product === "reliant") {
    const dbh = parseFloat(document.getElementById("dbh").value || "0");
    const pestId = document.getElementById("pest").value;
    const chosen = (cfg.pests || [])[0];
    const p = (cfg.pests || []).find(x=>x.id===pestId) || chosen;
    const productMl = p.rateMlPerIn * dbh;
    const waterMl = p.waterLPerIn * dbh * 1000;
    doseText.textContent = `Product: ${Math.round(productMl)} mL ${cfg.name} (${p.rateMlPerIn} mL/in Ã— ${dbh} in)`;
    waterText.textContent = `Water: up to ${Math.round(waterMl)} mL (â‰ˆ ${(waterMl/1000).toFixed(1)} L)`;
    totalText.textContent = `Apply by flare-root injection per label.`;
    return;
  }

  // Transtect 70
  if (product === "transtect70") {
    const dbh = parseFloat(document.getElementById("dbh").value || "0");
    const method = document.getElementById("method").value;
    const packets = Math.ceil(dbh / 17);
    doseText.textContent = `Product: ${packets} packet(s) Transtect 70 WSP for ${dbh} in DBH.`;
    if (method === "Bark spray (label)") {
      waterText.textContent = `Water: enough to wet bark (â‰ˆ1â€“2 gal total).`;
      totalText.textContent = `Spray to runoff.`;
    } else {
      const gals = Math.max(2, dbh * 0.25);
      const waterMl = gallonsToMl(gals);
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (â‰ˆ ${gals.toFixed(1)} gal)`;
      totalText.textContent = `Apply around root zone / injection sites.`;
    }
    return;
  }

  // injection insecticides
  if (product === "transtectInfusible" || product === "lepitect" || product === "mectinite") {
    const dbh = parseFloat(document.getElementById("dbh").value || "0");
    let perIn;
    if (product === "transtectInfusible") perIn = dbh < 12 ? 2 : (dbh < 24 ? 4 : 6);
    if (product === "lepitect")           perIn = dbh < 12 ? 4 : (dbh < 24 ? 6 : 8);
    if (product === "mectinite")          perIn = dbh < 12 ? 4 : (dbh < 24 ? 8 : 10);
    const productMl = perIn * dbh;
    doseText.textContent = `Product: ${Math.round(productMl)} mL ${cfg.name} (${perIn} mL/in Ã— ${dbh} in).`;
    waterText.textContent = `Water: per injection device / label (enough to deliver).`;
    totalText.textContent = `Inject evenly around root flare.`;
    return;
  }

  // Trimtect â€” your added one
  if (product === "trimtect") {
    const dbh = parseFloat(document.getElementById("dbh").value || "0");
    const method = document.getElementById("method").value;
    const productMl = 3 * dbh; // placeholder rate
    let waterMl;
    if (method === "Soil injection") {
      const gals = Math.max(1.5, dbh * 0.25);
      waterMl = gallonsToMl(gals);
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (â‰ˆ ${gals.toFixed(1)} gal)`;
    } else {
      const gals = 1.5;
      waterMl = gallonsToMl(gals);
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (example drench volume)`;
    }
    doseText.textContent = `Product: ${Math.round(productMl)} mL Trimtect (3 mL/in Ã— ${dbh} in)`;
    totalText.textContent = `Total: ${Math.round(productMl + waterMl)} mL`;
    return;
  }

  // spray products
  if (cfg.showSpray) {
    const sprayGal = parseFloat(document.getElementById("sprayVol").value || "0");
    const pestId = document.getElementById("pest").value;
    const chosen = (cfg.pests || [])[0];
    const p = (cfg.pests || []).find(x=>x.id===pestId) || chosen;

    // Onmark special
    if (product === "onmark") {
      const pct = p ? p.percent : 1;
      const totalMl = gallonsToMl(sprayGal);
      const productMl = totalMl * (pct / 100);
      doseText.textContent = `Product: ${Math.round(productMl)} mL Onmark for ${sprayGal} gal at ${pct}% solution.`;
      waterText.textContent = `Water: to ${sprayGal} gal.`;
      totalText.textContent = `Spray to wet target weeds.`;
      return;
    }

    // Biorush special
    if (product === "biorush") {
      const lb = (1/50) * sprayGal;
      const grams = lbToGrams(lb);
      doseText.textContent = `Product: ${lb.toFixed(3)} lb (${grams.toFixed(1)} g) Biorush Plus 3-0-11 for ${sprayGal} gal.`;
      waterText.textContent = `Water: to ${sprayGal} gal.`;
      totalText.textContent = `Apply as directed.`;
      return;
    }

    // Junction special
    if (product === "junction") {
      const lbPer100 = 1.5;
      const neededLb = lbPer100 * (sprayGal / 100);
      const grams = lbToGrams(neededLb);
      doseText.textContent = `Product: ${neededLb.toFixed(3)} lb (${grams.toFixed(1)} g) Junction DF for ${sprayGal} gal.`;
      waterText.textContent = `Water: to ${sprayGal} gal.`;
      totalText.textContent = `Spray to runoff.`;
      return;
    }

    // default spray
    const rate = (p && p.rateFlOzPer100) ? p.rateFlOzPer100 : 8;
    const neededFlOz = rate * (sprayGal / 100);
    const productMl = neededFlOz * 29.5735;
    doseText.textContent = `Product: ${Math.round(productMl)} mL ${cfg.name} for ${sprayGal} gal at ${rate} fl oz/100 gal.`;
    waterText.textContent = `Water: to ${sprayGal} gal total spray.`;
    totalText.textContent = `Apply with good coverage.`;
    return;
  }

  // MoistureAide special
  if (product === "moistureaide") {
    const dbh = parseFloat(document.getElementById("dbh").value || "0");
    const method = document.getElementById("method").value;
    const flOzPerIn = 6;
    const productMl = flOzPerIn * 29.5735 * dbh;
    if (method === "Soil injection") {
      const gals = 5 * dbh;
      const waterMl = gallonsToMl(gals);
      doseText.textContent = `Product: ${Math.round(productMl)} mL MoistureAide (${flOzPerIn} fl oz/in Ã— ${dbh} in).`;
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (â‰ˆ ${gals.toFixed(1)} gal)`;
      totalText.textContent = `Total: ${Math.round(productMl + waterMl)} mL.`;
    } else {
      const gals = 2;
      const waterMl = gallonsToMl(gals);
      doseText.textContent = `Product: ${Math.round(productMl)} mL MoistureAide.`;
      waterText.textContent = `Water: ${Math.round(waterMl)} mL (example drench).`;
      totalText.textContent = `Total: ${Math.round(productMl + waterMl)} mL.`;
    }
    return;
  }

  // default fallback
  doseText.textContent = "Calculator for this product not fully defined here.";
  waterText.textContent = "";
  totalText.textContent = "";
}

/* listeners for live calc */
document.getElementById("species").addEventListener("change", calcCambistat);
document.getElementById("dbhCambistat").addEventListener("input", calcCambistat);
document.getElementById("dbh").addEventListener("input", computeCurrentProduct);
document.getElementById("method").addEventListener("change", computeCurrentProduct);
document.getElementById("pest").addEventListener("change", computeCurrentProduct);
document.getElementById("sprayVol").addEventListener("input", computeCurrentProduct);
</script>
</body>
</html>
